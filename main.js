(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{nZ:()=>Q,xB:()=>K});var t=document.querySelector(".popup_images_open");function n(e){e.classList.add("popup_opened"),window.addEventListener("keydown",r)}function o(e){e.classList.remove("popup_opened"),window.removeEventListener("keydown",r)}function r(e){"Escape"===e.key&&o(document.querySelector(".popup_opened"))}document.querySelectorAll(".popup").forEach((function(e){e.addEventListener("mousedown",(function(t){t.target.classList.contains("popup_opened")&&o(e),t.target.classList.contains("popup__close")&&o(e)}))}));var c=document.querySelector(".popup_images"),a=document.querySelector(".popup__image"),u=document.querySelector(".popup__caption");function i(e,o){var r=document.querySelector(".template").content.querySelector(".element__card").cloneNode(!0),c=r.querySelector(".element__cards-item"),i=r.querySelector(".element__title"),l=r.querySelector(".element__heart-botton"),s=r.querySelector(".element__bin"),d=r.querySelector(".element__like"),p=r.querySelector(".element__bin");return c.src=e.link,c.alt=e.name,i.textContent=e.name,d.textContent=e.likes.length,function(e,t,n){for(var o=0;o<e.length;o++)e[o]._id==n&&t.classList.add("element__heart-botton_active")}(e.likes,l,o),l.addEventListener("click",(function(){return K(e._id,l,d)})),s.addEventListener("click",(function(){return Q(r,e._id)})),c.addEventListener("click",(function(){a.src=e.link,a.alt=e.name,u.textContent=e.name,n(t)})),e.owner._id==o&&p.classList.add("element__bin_active"),r}var l={formSelector:".popup__form",InputSelector:".popup__edit",errorClass:"popup__error",InputInvalidClass:"popup__edit_invalid",buttonSelectorSubmit:".popup__accept",buttonDisabledClass:"popup__accept_disabled"},s=function(e,t,n){var o=e.querySelector(n.buttonSelectorSubmit);d(t)?(o.classList.add(n.buttonDisabledClass),o.disabled=!0):(o.classList.remove(n.buttonDisabledClass),o.disabled=!1)},d=function(e){return e.some((function(e){return!e.validity.valid}))},p=function(e,t,n){var o=e.querySelector(".".concat(t.name,"-error"));t.validity.valid?f(t,o,n):_(t,o,t.validationMessage,n)},f=function(e,t,n){e.classList.remove(n.InputInvalidClass),t.classList.remove(n.errorClass),t.textContent=""},_=function(e,t,n,o){e.classList.add(o.InputInvalidClass),t.classList.add(o.errorClass),t.textContent=n},m={baseUrl:"https://mesto.nomoreparties.co/v1/plus-cohort7",headers:{authorization:"7ae2c7b1-ef91-4b42-9f75-558787176ab1","Content-Type":"application/json"}},y=function(e){return e.ok?e.json():Promise.reject("Обнаружен запуск ядерной ракеты: ".concat(e.status))};function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var v=document.querySelector(".popup_profile"),S=document.querySelector(".profile__name"),b=document.querySelector(".profile__text"),q=document.querySelector(".profile__button-edit"),g=document.querySelector(".popup_avatar"),L=document.querySelector(".popup__form_character"),E=document.querySelector(".popup__form_image"),C=document.querySelector(".popup__edit_user_name"),A=document.querySelector(".popup__edit_user_description"),k=document.querySelector(".popup__edit_image_place"),x=document.querySelector(".popup__edit_image_url"),I=document.querySelector(".elements__list"),w=document.querySelector(".profile__avatar"),O=document.querySelector(".profile__button-add"),j=document.querySelector(".popup__accept_image"),U=document.querySelector(".popup__container-profile-js"),T=Array.from(U.querySelectorAll(l.InputSelector)),D=document.querySelector(".popup__container-cards-js"),P=Array.from(D.querySelectorAll(l.InputSelector)),N=document.querySelector(".popup__container-avatar-js"),J=Array.from(N.querySelectorAll(l.InputSelector)),G=document.querySelector(".profile__avatar-edit"),H=document.querySelector(".popup__form_avatar"),M=document.querySelector(".popup__edit_user_avatar");function z(e){S.textContent=e.name,b.textContent=e.about}function B(e){w.src=e}q.addEventListener("click",(function(){C.value=S.textContent,A.value=b.textContent,n(v),p(L,C,l),p(L,A,l),s(U,T,l)})),G.addEventListener("click",(function(){n(g),s(N,J,l)})),O.addEventListener("click",(function(){n(c),s(D,P,l)})),L.addEventListener("submit",(function(e){e.preventDefault(),F(!0,$),function(e,t){return fetch("".concat(m.baseUrl,"/users/me"),{method:"PATCH",headers:m.headers,body:JSON.stringify({name:e.value,about:t.value})}).then(y)}(C,A).then((function(e){z(e),o(v)})).catch((function(e){console.log(e)})).finally((function(){F(!1,$)}))})),E.addEventListener("submit",(function(e){e.preventDefault(),F(!0,j),function(e,t){return fetch("".concat(m.baseUrl,"/cards"),{method:"POST",headers:m.headers,body:JSON.stringify({name:e.value,link:t.value})}).then(y)}(k,x).then((function(e){I.prepend(i(e,Z)),o(c),E.reset()})).catch((function(e){console.log(e)})).finally((function(){F(!1,j)}))}));var Z,$=document.querySelector(".popup__accept_avatar");function F(e,t){t.textContent=e?"Сохранение...":t==$?"Сохранить":"Создать"}function K(e,t,n){var o;t.classList.toggle("element__heart-botton_active"),t.classList.contains("element__heart-botton_active")?(o=e,fetch("".concat(m.baseUrl,"/cards/likes/").concat(o),{method:"PUT",headers:m.headers,body:JSON.stringify({})}).then(y)).then((function(){n.textContent=1*n.textContent+1})).catch((function(e){console.log(e)})):function(e){return fetch("".concat(m.baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:m.headers,body:JSON.stringify({})}).then(y)}(e).then((function(){n.textContent=1*n.textContent-1})).catch((function(e){console.log(e)}))}function Q(e,t){(function(e){return fetch("".concat(m.baseUrl,"/cards/").concat(e),{method:"DELETE",headers:m.headers,body:JSON.stringify({})}).then(y)})(t).then((function(){e.remove()})).catch((function(e){console.log(e)}))}H.addEventListener("submit",(function(e){var t;e.preventDefault(),F(!0,$),(t=M.value,fetch("".concat(m.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:m.headers,body:JSON.stringify({avatar:t})}).then(y)).then((function(e){B(e.avatar),o(g),H.reset()})).catch((function(e){console.log(e)})).finally((function(){F(!1,$)}))})),Promise.all([fetch("".concat(m.baseUrl,"/users/me"),{method:"GET",headers:m.headers}).then(y),fetch("".concat(m.baseUrl,"/cards"),{method:"GET",headers:m.headers}).then(y)]).then((function(e){var t,n,o=(n=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,c=[],a=!0,u=!1;try{for(n=n.call(e);!(a=(o=n.next()).done)&&(c.push(o.value),!t||c.length!==t);a=!0);}catch(e){u=!0,r=e}finally{try{a||null==n.return||n.return()}finally{if(u)throw r}}return c}}(t,n)||function(e,t){if(e){if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),r=o[0],c=o[1];Z=r._id,B(r.avatar),z(r),function(e,t){e.forEach((function(e){I.append(i(e,t))}))}(c,Z)})).catch((function(e){console.log("Отшиб__очка в промисс алл".concat(e))})),function(e){Array.from(document.querySelectorAll(e.formSelector)).forEach((function(t){t.addEventListener("submit",(function(e){e.preventDefault()})),function(e,t){var n=Array.from(e.querySelectorAll(t.InputSelector));n.forEach((function(o){o.addEventListener("input",(function(){p(e,o,t),s(e,n,t)}))}))}(t,e)}))}(l)})();